name: Build Flows in Shared (Push Tag)

on:
  push:
    tags:
      - '*.*.*-develop'
      - '*.*.*-staging'
      - '*.*.*'

jobs:
  call-workflow:
    uses: weni-ai/actions-workflows/.github/workflows/reusable-workflow.yaml@main
    with:
      image_repository: push-backend
      dockerfile: "docker/Dockerfile"
      build_args: |
        FLOWEDITOR_VERSION=${{ env.FLOWEDITOR_VERSION }}
        FLOWEDITOR_REPO=${{ env.FLOWEDITOR_REPO }}
        FLOWEDITOR_BRANCH=${{ env.FLOWEDITOR_BRANCH }}
      target_repository: weni-ai/kubernetes-manifests-platform
      target_repository_branch: main
      target_application: flows
      target_patch_file: deployment.json
    secrets: inherit
